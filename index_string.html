<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<name>妙味云盘</name>
		<link rel="stylesheet"  href="css/index.css"/>
	</head>
	<body>
		<section class="box">
			<header class="head">
				<h1 class="left">
					<a class="name" href="javaScript:;">妙味云盘</a>
				</h1>
				<div class="right">
					<div class="user">
						<a class="photo" href="javaScript:;"></a>
						<a class="more" href="javaScript:;"></a>
					</div>
					<span class="line"></span>
					<a class="option" href="javaScript:;" ></a>
				</div>
			</header>
			<div class="main clearfix">
				<nav class="top_nav">
					<ul class="nav_list clearfix">
						<li class="nav_item">
							<a class="nav_ico ico1" href="javaScript:;"></a>
							<a class="nav_text" href="javaScript:;">下载</a>
						</li>
						<li class="nav_item">
							<a class="nav_ico ico2" href="javaScript:;"></a>
							<a class="nav_text" href="javaScript:;">分享</a>
						</li>
						<li class="nav_item">
							<a class="nav_ico ico3" href="javaScript:;"></a>
							<a class="nav_text" href="javaScript:;">移动到</a>
						</li>
						<li class="nav_item">
							<a class="nav_ico ico4" href="javaScript:;"></a>
							<a class="nav_text" href="javaScript:;">重命名</a>
						</li>
						<li class="nav_item">
							<a class="nav_ico ico5" href="javaScript:;"></a>
							<a class="nav_text" id="del_filder" href="javaScript:;">删除</a>
						</li>
						<li class="nav_item">
							<a class="nav_ico ico6" href="javaScript:;"></a>
							<a class="nav_text" id="new_filder" href="javaScript:;">新建文件夹</a>
						</li>
						<li class="nav_item last">
							<a class="nav_ico ico7" href="javaScript:;"></a>
							<a class="nav_text" href="javaScript:;"></a>
						</li>
					</ul>
					<div class="topnav_right">
						<a class="right_ico"></a>
						<div class="rank">
							<a class="rank_ico" href="javaScript:;"></a>
							<a class="rankmore_ico" href="javaScript:;"></a>
							<div class="option">
								<a class="tiem" href="javaScript:;">按时间排序</a>
								<a class="letter" href="javaScript:;">按字母顺序</a>
								<a class="img" href="javaScript:;">显示缩略图</a>
							</div>
							<div class="option2">
								<a class="tiem2" href="javaScript:;"></a>
								<a class="letter2" href="javaScript:;"></a>
								<a class="img2" href="javaScript:;"></a>
							</div>
						</div>
					</div>
				</nav>
				<div class="main_left">
					<ul id="left_list">
					</ul>
					<!--<div class="wy_class">
						<div class="wy_info">
							<a class="wy_more" href="javaScript:;"></a>
							<a class="wy_text" href="javaScript:;">微云</a>
						</div>
						<div class="js_info">
							<a class="js_more" href="javaScript:;"></a>
							<a class="js_text" href="javaScript:;">js课程</a>
						</div>
						<ul class="js_list">
							<li class="js_item">
								<div class="item_123">
									<a href="javaScript:;">123</a>
								</div>
							</li>
							<li class="js_item">
								<div class="item_333">
									<a class="more" href="javaScript:;"></a>
									<a class="text" href="javaScript:;">333</a>
								</div>
							</li>
							<li class="js_item css">
								<div class="css_info">
									<a class="more" href="javaScript:;"></a>
									<a class="text" href="javaScript:;">CSS课程</a>
								</div>
								<div class="css_class">
									<a href="javaScript:;">CSS课程</a>
									<a href="javaScript:;">123</a>
									<a href="javaScript:;">JS基础课程</a>
								</div>
							</li>
							<li class="js_item item_other">
								<div class="item_11111">
									<a class="more" href="javaScript:;"></a>
									<a class="text" href="javaScript:;">11111</a>
								</div>
							</li>
							<li class="js_item">
								<div class="item_11111">
									<a class="more" href="javaScript:;"></a>
									<a class="text" href="javaScript:;">11111</a>
								</div>
							</li>
						</ul>
					</div>-->
				</div>
				<div class="main_right">
					
					<!--<form action="" >-->
						<div class="breadcrum clearfix">
							<input class="check" type="checkbox" />
							<ul class="option_list" id="nav_list">
								<!--<li class="option_item">
									<a class="option" href="javaScript:;">微云</a>
								</li class="option_item">
								<li class="option_item">
									<a class="option" href="javaScript:;">JS课程</a>
								</li >
								<li class="option_item">
									<a class="option" href="javaScript:;">CSS课程</a>
								</li>
								<li class="option_item ">
									<a class="option last option_active" href="javaScript:;">JS基础课程</a>
								</li>-->
							</ul>
						</div>
						<ul id="right_list">
						</ul>
						<!--<ul class="content_list">
							<li class="content_item js">
								<div class="item_left">
									<input class="check" type="checkbox" />
									<a class="content_text" href="javaScript:;">JS基础课程</a>
								</div>
								<div class="item_right">
									<a class="ico_control1" href="javaScript:;">下载</a>
									<a class="ico_control2" href="javaScript:;">分享</a>
									<a class="ico_control3" href="javaScript:;">移动</a>
									<a class="ico_control4" href="javaScript:;">添加</a>
									<a class="ico_control5" href="javaScript:;">删除</a>
								</div>
								<time class="time">
									2016-08-22 16:08
								</time>
							</li>
							<li class="content_item js2">
								<div class="item_left">
									<input class="check" type="checkbox" />
									<a class="content_text" href="javaScript:;">JS基础课程</a>
								</div>
								<div class="item_right">
									<a class="ico_control1" href="javaScript:;">下载</a>
									<a class="ico_control2" href="javaScript:;">分享</a>
									<a class="ico_control3" href="javaScript:;">移动</a>
									<a class="ico_control4" href="javaScript:;">添加</a>
									<a class="ico_control5" href="javaScript:;">删除</a>
								</div>
								<time class="time">
									2016-08-22 16:08
								</time>
							</li>
						</ul>-->
					<!--</form>-->
				</div>
			</div>
			
		</section>
		<script src="js/data.js"></script>
		<script src="js/tool.js"></script>
		<script src="js/createTreeByString.js"></script>
		<script src="js/createBread.js"></script>
		<script src="js/createFiles.js"></script>
		<!--<script src="js/view-tree-events.js"></script>-->
		<script src="js/data-add-del.js"></script>
		<script>
			var left_list = document.querySelector('#left_list');
			var right_list = document.querySelector('#right_list');
			var nav_list = document.querySelector('#nav_list');
			//创建左侧树形结构
//			var data = wy.getChildrenById(data,0);
			left_list.innerHTML =createTreeByString (data,0);  //string 生成
			

			//创建右侧导航结构
			nav_list.innerHTML=createBread (wy.getParentsById(data,3).reverse());
			
			//创建右侧文件夹结构
			right_list.innerHTML = createFiles(wy.getChildrenById(data,1));
		
		
			var new_filder = document.getElementById('new_filder');
			var del_filder = document.getElementById('del_filder');
			//新建文件夹按钮事件
			new_filder.onclick = function(){
				file_add_data(data[0].child);
				console.log(data);
				right_list.innerHTML = '';
				right_list.innerHTML = createFiles(wy.getChildrenById(data[0].child,0));
//				createFilder(right_list,);
				left_list.innerHTML = '';
				left_list.innerHTML =createTreeByString (data[0].child,0);
//				createList(left_list,data[0].child);
			}
			//删除文件夹按钮事件
			del_filder.onclick = function (){
				file_del_data (data);
				console.log(data);
				right_list.innerHTML = '';
				createFilder(right_list,data);
				left_list.innerHTML = '';
				createList(left_list,data);
			}
			//点击右边的文件夹 进入文件夹
			comeIn();
			function comeIn(){
				var fileImgs = document.querySelectorAll('.file-img');
				for (var i=0; i<fileImgs.length; i++) {
					fileImgs[i].onclick = function (){
						var thisId = this.dataset.id;
						console.log(thisId);
						var arr = wy.getChildrenById(data,Number.parseInt(thisId));
						var brr = wy.getItemById(data,Number.parseInt(thisId));
						if (brr.child) {
							right_list.innerHTML = '';
							right_list.innerHTML = createFiles(arr);
							comeIn();
						}else{
							right_list.innerHTML = '';
						}
						nav_list.innerHTML= '';
						nav_list.innerHTML=createBread (wy.getParentsById(data,Number.parseInt(thisId)).reverse());
					}
				}
			}
			
			//点击右边导航 后退文件夹
//			comeBack();
			function comeBack(){
				var navAs = document.querySelectorAll('.option');
			 	for (var i=0; i<navAs.length; i++) {
			 		navAs[i].onclick = function (){
			 			console.log('123');
			 			var thisId=Number.parseInt(this.dataset.id);
			 			console.log(thisId);
			 			var arr = wy.getChildrenById(data,thisId);
			 			var brr = wy.getParentsById(data,thisId).reverse();
			 			if (!thisId) {
			 				arr = wy.getChildrenById(data,thisId)[0].child;
			 			}
			 			console.log(arr);
						right_list.innerHTML = createFiles(arr);
						nav_list.innerHTML=createBread (brr);
						if (thisId){
							comeBack();
						}
			 		}
			 	}
			}
		 	//左边的H2点击事件
//		 	menuList(left_list);
		 	function menuList(ul){
			var children = ul.children;
			if (children[0].firstElementChild.onclick) {
				return;
			}
			for (var i=0; i<children.length; i++) {
				var h2 = children[i].firstElementChild;
				h2.onclick = function (){
					var thisId = Number.parseInt(this.dataset.id);
					var arr = wy.getChildrenById(data,thisId);
					var brr = wy.getParentsById(data,thisId).reverse();
					nav_list.innerHTML=createBread (brr);
					console.log(arr);
					right_list.innerHTML = '';
					var nextSibling = this.nextElementSibling;
					var parentParent = this.parentNode.parentNode;
					var uls = parentParent.getElementsByTagName('ul');
				if(nextSibling){
					right_list.innerHTML = createFiles(arr);
					for(var i=0; i<uls.length; i++){
						if (uls[i] != nextSibling) {
							uls[i].classList.remove('active');
							uls[i].previousElementSibling.firstElementChild.classList.remove('more_active');
						}
					}
					this.firstElementChild.classList.toggle('more_active');
					nextSibling.classList.toggle('active');
						menuList(nextSibling);
					}
				}
			}
		}
				
		</script>
	</body>
</html>
